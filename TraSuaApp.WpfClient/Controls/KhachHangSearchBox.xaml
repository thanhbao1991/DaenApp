<UserControl
    x:Class="TraSuaApp.WpfClient.Controls.KhachHangSearchBox"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="Root">
    <Grid>
        <!--  Lớp nền dùng để chứa TextBox + Button  -->
        <Grid>
            <TextBox
                x:Name="SearchTextBox"
                Padding="4,4,28,4"
                VerticalContentAlignment="Center"
                GotFocus="SearchTextBox_GotFocus"
                PreviewKeyDown="SearchTextBox_PreviewKeyDown"
                TextChanged="SearchTextBox_TextChanged" />

            <!--  Nút X để xóa  -->
            <Button
                x:Name="ClearButton"
                Click="ClearButton_Click"
                Style="{StaticResource ClearXButtonStyle}"
                Visibility="Collapsed" />
        </Grid>

        <!--  Popup hiển thị danh sách kết quả  -->
        <Popup
            x:Name="Popup"
            AllowsTransparency="True"
            IsOpen="{Binding IsPopupOpen, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=OneWay}"
            Placement="Bottom"
            PlacementTarget="{Binding ElementName=SearchTextBox}"
            PopupAnimation="Slide"
            StaysOpen="False"
            VerticalOffset="2">
            <Border
                Background="White"
                BorderBrush="Gray"
                BorderThickness="1">
                <ListBox
                    x:Name="ListBoxResults"
                    Width="310"
                    MaxHeight="310"
                    BorderBrush="Transparent"
                    MouseLeftButtonUp="ListBoxResults_MouseLeftButtonUp"
                    ScrollViewer.HorizontalScrollBarVisibility="Hidden">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Grid.ColumnSpan="2"
                                    FontWeight="Bold"
                                    Text="{Binding Ten}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="0"
                                    FontSize="12"
                                    Foreground="Gray"
                                    Text="{Binding DienThoai}" />
                                <TextBlock
                                    Grid.Row="1"
                                    Grid.Column="1"
                                    FontSize="12"
                                    Foreground="Gray"
                                    Text="{Binding DiaChi}" />
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Border>
        </Popup>
    </Grid>
</UserControl>