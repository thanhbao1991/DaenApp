<UserControl
    x:Class="TraSuaApp.WpfClient.Controls.LoadingButton"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="root">
    <UserControl.Resources>
        <!--  Storyboard đổi màu chữ  -->
        <Storyboard
            x:Key="BlinkColorStoryboard"
            AutoReverse="True"
            RepeatBehavior="Forever">
            <ColorAnimation
                Storyboard.TargetName="ButtonText"
                Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)"
                From="{StaticResource LightBrush}"
                To="{StaticResource LightBrush}"
                Duration="0:0:0.5" />
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <Button
            x:Name="MainButton"
            MinWidth="80"
            VerticalAlignment="Center"
            Background="{StaticResource SuccessBrush}"
            BorderBrush="Transparent"
            BorderThickness="0"
            Cursor="Hand"
            FontWeight="SemiBold"
            Foreground="{StaticResource LightBrush}"
            IsEnabled="{Binding IsBusy, ElementName=root, Converter={StaticResource InverseBoolConverter}}"
            Opacity="1"
            SnapsToDevicePixels="True">
            <Button.Template>
                <ControlTemplate TargetType="Button">
                    <Border
                        Padding="8"
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        CornerRadius="8">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                </ControlTemplate>
            </Button.Template>

            <StackPanel
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Orientation="Horizontal">
                <!--  Spinner  -->
                <Viewbox
                    Width="16"
                    Height="16"
                    Margin="0,0,6,0"
                    Visibility="{Binding IsBusy, ElementName=root, Converter={StaticResource BoolToVisibilityConverter}}">
                    <Canvas Width="16" Height="16">
                        <Ellipse
                            Width="12"
                            Height="12"
                            Opacity="0.3"
                            Stroke="{StaticResource LightBrush}"
                            StrokeThickness="2" />
                        <Ellipse
                            Width="12"
                            Height="12"
                            Stroke="{StaticResource LightBrush}"
                            StrokeDashArray="6 6"
                            StrokeThickness="2">
                            <Ellipse.RenderTransform>
                                <RotateTransform x:Name="SpinnerRotate" Angle="0" CenterX="6" CenterY="6" />
                            </Ellipse.RenderTransform>
                            <Ellipse.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimation
                                                Storyboard.TargetName="SpinnerRotate"
                                                Storyboard.TargetProperty="Angle"
                                                From="0"
                                                To="360"
                                                Duration="0:0:1" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Ellipse.Triggers>
                        </Ellipse>
                    </Canvas>
                </Viewbox>

                <!--  Text  -->
                <TextBlock
                    x:Name="ButtonText"
                    VerticalAlignment="Center"
                    FontWeight="Medium"
                    Foreground="{StaticResource LightBrush}"
                    Text="{Binding Content, ElementName=root}" />
            </StackPanel>
        </Button>
    </Grid>
</UserControl>
